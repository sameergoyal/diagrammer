import { Meta } from "@storybook/addon-docs";

<Meta title="Docs/Plugins/Detect Interaction" />

# Detect Interaction

If your plugin renders additional UI elements, it may optionally want to use Diagrammer's UI events module to detect and normalize those events. In those cases, the plugin could choose to expose a function that consumers will use inside their own eventListener configuration when initializing diagrammer.

**Example: Attaching an event listener**

```javascript
const diagrammer = new Diagrammer(
  ...{
    eventListener: (event: NormalizedEvent) => {
      handleTestPluginEvent(event);
    },
  }
);
```

**Note**: Some plugins might require access to the diagrammer instance inside their event listeners. To avoid circular references when initializing diagrammer for such plugins, use a wrapper object like below.

**Example: Passing diagrammer instance to plugin event listener**

```javascript
const wrapper = { diagrammer: null };
wrapper.diagrammer = new Diagrammer(
  ...{
    eventListener: (event: NormalizedEvent) => {
      handleTestPluginEvent(event, wrapper.diagrammer);
    },
  }
);
```

**Example: Sample event listener**

```javascript
export function handleTestPluginEvent(
  event: NormalizedEvent,
  diagrammer: Diagrammer
) {
  if (event.type === Event.LEFT_CLICK && event.target.type === "testPlugin") {
    const state = diagrammer.store.getState();
    if (!state.plugins) return;
    const position = state.plugins.testPlugin.data.workspacePos;

    diagrammer.api.dispatch({
      payload: { position },
      type: WorkspaceActions.WORKSPACE_DRAG,
    });
  }
}
```
